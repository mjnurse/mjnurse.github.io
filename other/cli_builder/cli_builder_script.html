<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="CLI builder" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://kit.fontawesome.com/fa62c117c7.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/lunr/lunr.js"></script>
    <link rel="stylesheet" href="/static/styles.css" />
    <link rel="stylesheet" href="/static/syntax.css" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title>CLI builder</title>
  </head>
  <body class="light" id="top">
    <header class="header center">
      <h3>
        <a href="/" class="link">MjN</a>
      </h3>

      <nav class="nav center">
        <ul class="nav__list center">
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/blog/" data-shortcut="b"><strong>b</strong>log</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/cheatsheets/" data-shortcut="c"><strong>c</strong>heatsheets</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/elasticsearch/" data-shortcut="e"><strong>e</strong>lasticsearch</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/js/" data-shortcut="j"><strong>j</strong>s</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/linuxbash/" data-shortcut="l"><strong>l</strong>inuxbash</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/misc/" data-shortcut="m"><strong>m</strong>isc</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/notes/" data-shortcut="n"><strong>n</strong>otes</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/other/" data-shortcut="o"><strong>o</strong>ther</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/shortcutkeys/" data-shortcut="s"><strong>s</strong>hortcutkeys</a>
          </li>
          
        </ul>

        <button type="button" aria-label="search" id="searchBtn" class="btn btn--icon">
          <i aria-hidden="true" class="fas fa-search"></i>
        </button>

        <button type="button" aria-label="toggle theme" class="btn btn--icon">
          <i aria-hidden="true" id="btn-theme" class="fas fa-moon"></i>
        </button>

        <button
          type="button"
          aria-label="toggle navigation"
          class="btn btn--icon nav__hamburger"
        >
          <i aria-hidden="true" class="fas fa-bars"></i>
        </button>
      </nav>
    </header>

    <main>
      <article class="article">
        <div class="article-body">
          <h1>CLI builder</h1>
<p>This bash script generates a cli (command line interface) bash script from a
definition file.  The structure of the definition file is code header below. 
This script also generates an alias file which contains a set of alias
commands which run each command in the definition file using the associated
shortcut prepended with an '@'.</p>
<pre class="codehilite"><code class="language-bash">#!/bin/bash
help_text=&quot;
NAME
  cli-builder - A bash script which generates a CLI bash script from a definition file.

USAGE
  cli-builder [-d] &lt;definition_filename&gt;

OPTIONS
  -d
    Run in debug mode.

  -h|--help
    Show help text.

DESCRIPTION
  This bash script generates a cli (command line interface) bash script from a definition file.
  The structure of the definition file is described below.  This script also generates an alias
  file which contains a set of alias commands which run each command in the definition file using
  the associated shortcut prepended with an '@'.

  Definition File Structure
   -------------------------

  # - a line starting with a # is a comment

  = - a line starting with a = is a group description for the set of commands following this
      line up until the next line starting with a = or the end of the file.

  ( / - is the line continuation character.  Any line ending / is joined to the next line. )

  All other lines in the file are command definitions.  These lines are structured as follows:

  name-1..name-n (shortcut) &lt;param&gt; [&lt;opt_param] :: command \$1 \$2

  Where:

  name-1..name-n
    A list of words which describe the command and which are typed to run the command.

  shortcut
    A single word which can also be typed to run the command.  If the aliases are created
    then the alias can also be run direct from the command as @alias.

  param
    A mandatory parameter.  There can be 0 or more mandatory parameters.

  opt_param
    A optional parameter.  There can me 0 or more optional parameters.  The must always follow
    the mandatory parameters and there can be no gaps.  This means if optional parameter 3 is
    passed in so must optional parameters 1 and 2.

  ::
    Separates the command definition with the Linux command that is run.

  command
    Is an Linux command.  Parameter values entered after the command are specified using there
    position preceded by a \$.  e.g \$1, \$2.

  Example

  sort_cli.def:
  ----------------------------------------------------------------
  # FILE OPTIONS
  sort file (sf) &lt;filename&gt; &lt;sort_parameter&gt; :: cat \$1 | sort \$2
  ----------------------------------------------------------------

  This example sorts a file specified by a mandatory filename.  An optional sort parameter can
  be passed to modify the sort order.  Once the cli is built the command can be run as follows.
  Note: the name of the cli command is the same as the name of the definition file
  (without the .def).

  &gt; sort_cli sort file my_file

  &gt; sort_cli sf my_file --ignore_case

  &gt; @sf my_file

AUTHOR
  mjnurse - 2019
&quot;
name=${0##*/}
try=&quot;Try '$name -h' for more information&quot;

# Get usage from help_text.
usage=${help_text##*USAGE}
usage=${usage%%OPTIONS*}
usage=${usage%%PARAMETERS*}
usage=${usage%%DESCRIPTION*}
usage=${usage//[$'\n\r']}
usage=${usage##*   }
usage=&quot;Usage: ${usage}&quot;

function debug {
  if [[ $debug_yn == y ]]; then
    echo &quot;$*&quot;
  fi
}

debug_yn=n

if [[ &quot;$1&quot; == &quot;&quot; ]]; then
  echo $usage
  echo $try
  exit
elif [[ &quot;$1&quot; == &quot;-h&quot; || &quot;$1&quot; == &quot;--help&quot; ]]; then
  echo &quot;$help_text&quot; 
  exit
elif [[ &quot;$1&quot; == &quot;-d&quot; ]]; then
  debug_yn=y
  shift
fi

def_file=&quot;${1/.def/}&quot;

if [[ ! -f $def_file.def ]]; then
  echo &quot;Error: Definition file \&quot;$def_file.def\&quot; missing&quot;
  exit
fi
cli_name=${def_file}
defns=&quot;$(cat $def_file.def | sed 's/^  *//' | sed ':a;/\\ *$/{N;s/\\ *\n//;ba}' | sed '/^ *#/d; s/(\(.*::\)/('${cli_name:0:1}'\1/')&quot;

CCYA=&quot;\x1b[96m&quot;
CGRE=&quot;\x1b[92m&quot;
CMAG=&quot;\x1b[95m&quot;
CWHI=&quot;\x1b[97m&quot;
CDEF=&quot;\x1b[0m&quot;

echo '#!/bin/bash

debug_yn=n
if [[ &quot;$1&quot; == &quot;-d&quot; ]]; then
  debug_yn=y
  shift
fi
if [[ &quot;${CLI_DEBUG^^}&quot; == &quot;TRUE&quot; ]]; then
  debug_yn=y
fi

l80=&quot;--------------------------------------------------------------------------------&quot;
' &gt; $cli_name

echo '# Shortcut aliases' &gt; $cli_name.alias

defns=$defns'
= HELP
help ('${cli_name:0:1}'he) :: egrep &quot;usage=|section=&quot; &quot;$0&quot; | grep -v &quot;grep&quot; | sed &quot;s/.*usage=/   /; s/.*section=/'$CGRE'/; s/\&quot;//g&quot;
'

echo '
function check_params() {
  # param 1 - actual number of parameters
  # param 2 - required number of parameters
  # param 3 - incorrect parameters message

  if [[ &quot;$1&quot; &lt; &quot;$2&quot; ]]; then
    echo &quot;$3&quot;
    exit
  fi
}

function print_command() {
  # param 1 - command

  if [[ $debug_yn == y ]]; then
    echo &quot;COMMAND: $*&quot; | sed '&quot;'&quot;'s/./-/g'&quot;'&quot;'
    echo &quot;COMMAND: $*&quot; | sed '&quot;'&quot;'s/&quot;/\&quot;/g'&quot;'&quot;'
    echo &quot;COMMAND: $*&quot; | sed '&quot;'&quot;'s/./-/g'&quot;'&quot;'
  fi
}
' &gt;&gt; $cli_name

debug &quot;Commands&quot;
debug &quot;--------&quot;

echo &quot;$defns&quot; | \
while IFS= read -r line ; do

  if [[ &quot;${line:0:1}&quot; == &quot;=&quot; ]]; then
    echo &quot;section=\&quot;${line:2}\&quot;&quot;  &gt;&gt; $cli_name
  elif [[ &quot;${line:0:4}&quot; == &quot;cmd &quot; ]]; then
    echo &quot;${line:4:99999}&quot; &gt;&gt; $cli_name
  elif [[ &quot;$line&quot; != &quot;&quot; ]]; then
    cmd=&quot;$(echo $line | sed 's/^.*:://; s/##.*//')&quot;
    usage=&quot;$(echo ${line%% ::*} | sed &quot;s/\[/\x1b[37m\[/g; s/\]/\]$CWHI/g; s/^/$CMAG/; s/(/$CCYA(/; s/)/)$CWHI/; s/$/$CDEF/&quot;)&quot;
    if echo $line | grep &quot;##&quot; &gt; /dev/null; then help=&quot;$(echo $line | sed &quot;s/^.*## */$CGRE # /; s/$/\x1b[0m/&quot;)&quot;; else help=&quot;&quot;; fi
    word_list=&quot;${line%%::*}&quot;
    word_list=${word_list//[/ [ }
    word_list=${word_list//]/ ] }

    key_word_template=&quot;&quot;
    key_words=&quot;&quot;
    num_mandatory_params=0
    optional_params_yn=n
    optional_params=&quot;&quot;
    mandatory_params=&quot;&quot;
    shortcut=&quot;&quot;
    word_count=0

    for word in $word_list; do
      if [[ &quot;$word&quot; == &quot;[&quot; ]]; then
        optional_params_yn=y
      elif [[ &quot;$word&quot; == &quot;]&quot; ]]; then
        optional_params_yn=n
      elif [[ &quot;${word:0:1}&quot; == &quot;&lt;&quot; ]]; then
        if [[ &quot;$optional_params_yn&quot; == &quot;y&quot; ]]; then
          optional_params=&quot;$optional_params $word&quot;
        else
          mandatory_params=&quot;$mandatory_params $word&quot;
          let num_mandatory_params=num_mandatory_params+1
        fi
      elif [[ &quot;${word:0:1}&quot; == &quot;(&quot; ]]; then
        shortcut=${word/(/}
        shortcut=${shortcut/)/}
        echo 'alias @'${shortcut}'=&quot;'$cli_name $shortcut'&quot;' &gt;&gt; $cli_name.alias
      else
        let word_count=word_count+1
        key_words=&quot;$key_words $word&quot;
        key_word_template=&quot;$key_word_template &quot;'$'&quot;$word_count&quot;
      fi
    done

    key_words=${key_words:1}
    key_word_template=${key_word_template:1}
    mandatory_params=${mandatory_params:1}
    optional_params=${optional_params:1}
    while [[ &quot;${cmd:0:1}&quot; == &quot; &quot; ]]; do
      cmd=${cmd:1}
    done

    debug &quot;- $key_words ($shortcut)&quot;

    echo &quot;if [[ \&quot;$key_word_template\&quot; == \&quot;$key_words\&quot; || \&quot;&quot;'$1'&quot;\&quot; == \&quot;$shortcut\&quot; ]]; then&quot;  &gt;&gt; $cli_name
    echo &quot;   if [[ \&quot;&quot;'$1'&quot;\&quot; == \&quot;$shortcut\&quot; ]]; then shift; else shift $word_count; fi&quot;  &gt;&gt; $cli_name
    echo &quot;   usage=\&quot;$usage $help\&quot;&quot;  &gt;&gt; $cli_name
    echo &quot;   check_params &quot;'$'&quot;# $num_mandatory_params \&quot;Usage: &quot;'$'&quot;usage\&quot;&quot;  &gt;&gt; $cli_name
    if [[ &quot;$key_words&quot; != &quot;h&quot; &amp;&amp; &quot;$key_words&quot; != &quot;help&quot; ]]; then
      echo &quot;   print_command \&quot; ${cmd//\&quot;/\\\&quot;}&quot; \&quot;  &gt;&gt; $cli_name
    fi
    echo &quot;   $cmd&quot;  &gt;&gt; $cli_name
    echo &quot;   exit&quot;  &gt;&gt; $cli_name
    echo &quot;fi&quot;  &gt;&gt; $cli_name
  fi
done

echo '
if [[ &quot;$1&quot; == &quot;&quot; ]]; then
  echo &quot;No option passed&quot;
else
  echo &quot;$*: invalid option&quot;
fi
echo &quot;Try \&quot;'$cli_name' help\&quot; for more information.&quot;
' &gt;&gt; $cli_name

chmod +x $cli_name

cp $cli_name.alias ~
</code></pre>
        </div>
      </article>
    </main>

    <footer class="footer">
      <p>
        <a href="/about_me.html" class="link">About Me</a> | 
        <a href="/help.html" class="link">Help</a>
      </p>
      <p>
        <a href="https://github.com/mjnurse" target="_blank" rel="noopener noreferrer" aria-label="GitHub" class="link footer__link">
          <i aria-hidden="true" class="fab fa-github"></i>
        </a>
        <a href="https://www.linkedin.com/in/martin-nurse" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="link footer__link">
          <i aria-hidden="true" class="fab fa-linkedin"></i>
        </a>
      </p>
      <p>Last updated: December 11, 2025</p>
    </footer>

    <div class="scroll-container">
      <div class="scroll-top">
        <a aria-label="Scroll up" href="#top">
          <i aria-hidden="true" class="fas fa-arrow-up"></i>
        </a>
      </div>
    </div>

    <script src="/static/page-nav.js"></script>
    <script src="/static/script.js"></script>
    <script src="/static/search.js"></script>
  </body>
</html>