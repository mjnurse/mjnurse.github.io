<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="DOS - Cmd Cheat Sheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://kit.fontawesome.com/fa62c117c7.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/lunr/lunr.js"></script>
    <link rel="stylesheet" href="/static/styles.css" />
    <link rel="stylesheet" href="/static/syntax.css" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title>DOS - Cmd Cheat Sheet</title>
  </head>
  <body class="light" id="top">
    <header class="header center">
      <h3>
        <a href="/" class="link">MjN</a>
      </h3>

      <nav class="nav center">
        <ul class="nav__list center">
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/blog/" data-shortcut="b"><strong>b</strong>log</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/cheatsheets/" data-shortcut="c"><strong>c</strong>heatsheets</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/elasticsearch/" data-shortcut="e"><strong>e</strong>lasticsearch</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/js/" data-shortcut="j"><strong>j</strong>s</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/linuxbash/" data-shortcut="l"><strong>l</strong>inuxbash</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/misc/" data-shortcut="m"><strong>m</strong>isc</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/notes/" data-shortcut="n"><strong>n</strong>otes</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/other/" data-shortcut="o"><strong>o</strong>ther</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/shortcutkeys/" data-shortcut="s"><strong>s</strong>hortcutkeys</a>
          </li>
          
        </ul>

        <button type="button" aria-label="search" id="searchBtn" class="btn btn--icon">
          <i aria-hidden="true" class="fas fa-search"></i>
        </button>

        <button type="button" aria-label="toggle theme" class="btn btn--icon">
          <i aria-hidden="true" id="btn-theme" class="fas fa-moon"></i>
        </button>

        <button
          type="button"
          aria-label="toggle navigation"
          class="btn btn--icon nav__hamburger"
        >
          <i aria-hidden="true" class="fas fa-bars"></i>
        </button>
      </nav>
    </header>

    <main>
      <article class="article">
        <div class="article-body">
          <h1>DOS - Cmd Cheat Sheet</h1>
<div class="table-of-contents">
<h2>Contents</h2>
<ul>
<li><a href="#variables">Variables</a></li>
<li class="toc-h2"><a href="#variable-substitution">Variable Substitution</a></li>
<li class="toc-h2"><a href="#environment-variables">Environment Variables</a></li>
<li><a href="#read-user-input">Read user Input</a></li>
<li><a href="#if-condition">IF Condition</a></li>
<li class="toc-h2"><a href="#file-syntax">File syntax</a></li>
<li class="toc-h2"><a href="#string-syntax">String syntax</a></li>
<li class="toc-h2"><a href="#error-check-syntax">Error Check Syntax</a></li>
<li class="toc-h2"><a href="#parenthesis">Parenthesis</a></li>
<li class="toc-h2"><a href="#an-and-test">An AND test:</a></li>
<li class="toc-h2"><a href="#an-or-test">An OR test:</a></li>
<li><a href="#loops">Loops</a></li>
<li><a href="#other">Other</a></li>
<li class="toc-h2"><a href="#setting-file-attributes">Setting File Attributes</a></li>
<li><a href="#working-with-tasks-processes">Working with tasks (processes):</a></li>
<li><a href="#an-example-script-to-process-command-line-parameters">An example script to process command line parameters</a></li>
<li><a href="#a-script-to-emulate-the-linux-sudo-command">A script to emulate the linux sudo command:</a></li>
<li><a href="#other">Other</a></li>
</ul>
</div>
<h1 id="variables">Variables</h1>
<pre class="codehilite"><code class="language-bat">SET b=%a:x=y%   # Replace 'x' with 'y'.
SET b=%a:xy=%   # Delete the string 'xy'.
SET b=%a:*xy=%  # Delete the string 'xy' and everything before it.
SET b=%a: =%    # Remove spaces from a string.

SET s=martin
ECHO %s:~1%     # Yeilds: artin
ECHO %s:~,-2%   # Yields: mart
ECHO %s:~1,-1%  # Yields: arti
ECHO %s:~1,2%   # Yields: ar
</code></pre>

<p>To remove characters from the right hand side of a string is a two step process - To delete everything after the string 't':</p>
<pre class="codehilite"><code class="language-bat">SET a=Martin
SET tmp=%a:*t=%          # Create tmp string removing 't' and everything before it.
CALL SET b=%%a:%tmp%=%%  # Remove tmp from original string.  Use CALL to expand tmp before replace.
</code></pre>

<p>Boolean Test "does string exist ?" - To test for string 'Three':</p>
<pre class="codehilite"><code class="language-bat">SET a=&quot;One, Two, Three&quot;
SET tmp=%a:Three=%      # Create tmp string removing 'Three' if it exists, then compare or original.
IF NOT %tmp% == %a% (ECHO found.) ELSE (ECHO Not found.)
</code></pre>

<h2 id="variable-substitution">Variable Substitution</h2>
<p>| <code>%~V</code> | expands %V removing any surrounding quotes (") |
| <code>%~fV</code> | expands %V to a fully qualified path name |
| <code>%~dV</code> | expands %V to a drive letter only |
| <code>%~pV</code> | expands %V to a path only (directory with ) |
| <code>%~nV</code> | expands %V to a file name only |
| <code>%~xV</code> | expands %V to a file extension only |
| <code>%~sV</code> | expanded path contains short names only |
| <code>%~aV</code> | expands %V to file attributes of file |
| <code>%~tV</code> | expands %V to date/time of file |
| <code>%~zV</code> | expands %V to size of file |</p>
<h2 id="environment-variables">Environment Variables</h2>
<pre class="codehilite"><code class="language-bat">setx &lt;var_name&gt; &lt;var_value&gt; [/M]
</code></pre>

<p><code>/M</code> makes this a System variable rather than User variable.  <code>/M</code> requires administrator privileges.</p>
<h1 id="read-user-input">Read user Input</h1>
<pre class="codehilite"><code>set /p &quot;value=Enter value: &quot;
echo %value%
</code></pre>

<h1 id="if-condition">IF Condition</h1>
<h2 id="file-syntax">File syntax</h2>
<pre class="codehilite"><code class="language-bat">IF [NOT] EXIST filename command 
IF [NOT] EXIST filename (command) ELSE (command)
</code></pre>

<h2 id="string-syntax">String syntax</h2>
<pre class="codehilite"><code class="language-bat">IF [/I] [NOT] item1==item2 command   # /I - case insensitive.
IF [/I] item1 compare-op item2 command
IF [/I] item1 compare-op item2 (command) ELSE (command)

IF [%1]==[] ECHO Value Missing  # Check for missing command line parameter.  (can use EQU in place of ==)

# Compare-op can be: EQU (==), NEQ (!=), LSS (&lt;), LEQ (&lt;=), GTR (?), GEQ (&gt;=).
# (This syntax is necessary because the &gt; and &lt; symbols are redirection operators)

# The == comparison operator always results in a string comparison.  EQU will compare numbers.

# Filenames/Paths - Always surround them with quotes: if %_myvar% contains &quot;C:\Some Path&quot; then 
# comparison becomes IF [&quot;C:\Some Path&quot;] EQU []
</code></pre>

<h2 id="error-check-syntax">Error Check Syntax</h2>
<pre class="codehilite"><code class="language-bat">IF [NOT] DEFINED variable command  # Note: DEFINED will return true for a space character.
IF [NOT] ERRORLEVEL number command 
IF CMDEXTVERSION number command
</code></pre>

<h2 id="parenthesis">Parenthesis</h2>
<p>Parenthesis can be used to split commands across multiple lines.</p>
<pre class="codehilite"><code class="language-bat">IF EXIST filename.txt (
    ECHO Deleting filename.txt
    DEL filename.txt
 ) ELSE (             # Note: Always put the parenthesis on the same line as ELSE.
    ECHO The file was not found.
 )
</code></pre>

<h2 id="an-and-test">An AND test:</h2>
<pre class="codehilite"><code class="language-bat">IF SomeCondition (
   IF SomeOtherCondition (
     Command_if_both_are_true
   )
)
</code></pre>

<h2 id="an-or-test">An OR test:</h2>
<pre class="codehilite"><code class="language-bat">SET &quot;tmp=&quot;
IF SomeCondition SET tmp=1
IF SomeOtherCondition SET tmp=1
IF %tmp% EQU 1 Command_to_run_if_either_is_true
</code></pre>

<h3 id="notes">Notes:</h3>
<ul>
<li>Delimiters - If the string being compared includes delimiters such as [Space] or [Comma], then the delimiters must be escaped with a caret ^ or the whole string must be "quoted".</li>
<li>Wildcards - Wildcards are not supported by IF.  Use variable string transforms instead.</li>
</ul>
<h1 id="loops">Loops</h1>
<pre class="codehilite"><code class="language-bat">FOR %%f IN (file1.txt file2.txt) DO ECHO %%f
FOR /L %%i IN (0,2,10) DO ECHO %%i # Yields 0 2 4 6 8 10
FOR /F %%l IN (file.txt) DO ECHO %%l

# delims= overrides default space delimiter so whole line is a single token
FOR /F &quot;delims=&quot; %%line IN (file.txt) DO ECHO %%line
# tokens=* overrides default token=1 to return all tokens using the default space delimiter
FOR /F &quot;tokens=*&quot; %%line IN (file.txt) DO ECHO %%line
FOR /F &quot;tokens=*&quot; %%character IN (&quot;I am cool&quot;) DO ECHO %%character
FOR /F &quot;tokens=*&quot; %%l IN ('DIR /B') DO ECHO %%l
</code></pre>

<h1 id="other">Other</h1>
<ul>
<li>To echo the &gt; symbol use: ^&gt;</li>
<li>To echo the % symbol use: %%</li>
<li>To exit script but not the cmd.exe: <code>exit /B</code></li>
</ul>
<h2 id="setting-file-attributes">Setting File Attributes</h2>
<ul>
<li><code>attrib -r &lt;filename&gt;</code> - removes readonly</li>
</ul>
<h1 id="working-with-tasks-processes">Working with tasks (processes):</h1>
<pre class="codehilite"><code class="language-bat">:: List tasks
&gt; tasklist

:: Kill task
taskkill /F /PID &lt;pid_number&gt;
taskkill /IM &lt;&quot;process name&quot;&gt; /F
</code></pre>

<h1 id="an-example-script-to-process-command-line-parameters">An example script to process command line parameters</h1>
<pre class="codehilite"><code class="language-bat">@ECHO OFF
SETLOCAL EnableDelayedExpansion
(SET n=^
%doNotDeleteThisLine%
)
GOTO :START

:HELP
ECHO !n!^
A sample script to parse command line parameters. !n!^
                                                  !n!^
process-params [/D] [/H] [/V value]               !n!^
                                                  !n!^
  /D   Enable Debug.                              !n!^
  /H   Displays this help.                        !n!^
  /V   Sets variable value.                       !n!

EXIT /B
:START

SET debugYN=N
SET val=

:LOOP
  IF [%1]==[] GOTO :END_LOOP
  SET par=%1
  SHIFT

  IF [%par%]==[/H] (
    GOTO :HELP
  )

  IF [%par%]==[-d] (
    SET debugYN=Y
    GOTO :LOOP
  )

  IF [%par%]==[-v] (
    SET val=%1
    SHIFT
    GOTO :LOOP
  )

  ECHO NOT PROCESSED %par%
  GOTO :LOOP
:END_LOOP

ECHO debugYN: %debugYN%
ECHO value:   %val%
</code></pre>

<h1 id="a-script-to-emulate-the-linux-sudo-command">A script to emulate the linux sudo command:</h1>
<p>Create a script <code>sudo.bat</code>:</p>
<pre class="codehilite"><code class="language-bat">@echo Set objShell = CreateObject(&quot;Shell.Application&quot;) &gt; %temp%\sudo.tmp.vbs
@echo args = Right(&quot;%*&quot;, (Len(&quot;%*&quot;) - Len(&quot;%1&quot;))) &gt;&gt; %temp%\sudo.tmp.vbs
@echo objShell.ShellExecute &quot;%1&quot;, args, &quot;&quot;, &quot;runas&quot; &gt;&gt; %temp%\sudo.tmp.vbs
@cscript %temp%\sudo.tmp.vbs
</code></pre>

<p>To open a new cmd window running as administrator:</p>
<pre class="codehilite"><code class="language-bat">&gt; sudo cmd
</code></pre>

<p>I did have some issues if I pass in multiple parameters to sudo, but I'll leave that for another day.</p>
<h1 id="other_1">Other</h1>
<pre class="codehilite"><code class="language-bat">:: Get current directory
SET curr_dir=%cd%
</code></pre>

<hr>
        </div>
      </article>
    </main>

    <footer class="footer">
      <p>
        <a href="/about_me.html" class="link">About Me</a> | 
        <a href="/help.html" class="link">Help</a>
      </p>
      <p>
        <a href="https://github.com/mjnurse" target="_blank" rel="noopener noreferrer" aria-label="GitHub" class="link footer__link">
          <i aria-hidden="true" class="fab fa-github"></i>
        </a>
        <a href="https://www.linkedin.com/in/martin-nurse" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="link footer__link">
          <i aria-hidden="true" class="fab fa-linkedin"></i>
        </a>
      </p>
      <p>Last updated: December 11, 2025</p>
    </footer>

    <div class="scroll-container">
      <div class="scroll-top">
        <a aria-label="Scroll up" href="#top">
          <i aria-hidden="true" class="fas fa-arrow-up"></i>
        </a>
      </div>
    </div>

    <script src="/static/page-nav.js"></script>
    <script src="/static/script.js"></script>
    <script src="/static/search.js"></script>
  </body>
</html>