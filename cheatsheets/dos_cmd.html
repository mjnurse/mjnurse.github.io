<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="description" content="DOS - Cmd Cheat Sheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;700&display=swap"
      rel="stylesheet"
    />
    <script
      src="https://kit.fontawesome.com/fa62c117c7.js"
      crossorigin="anonymous"
    ></script>
    <script src="https://unpkg.com/lunr/lunr.js"></script>
    <link rel="stylesheet" href="/static/styles.css" />
    <link rel="stylesheet" href="/static/syntax.css" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title>DOS - Cmd Cheat Sheet</title>
  </head>
  <body class="light" id="top">
    <header class="header center">
      <h3>
        <a href="/" class="link">MjN</a>
      </h3>

      <nav class="nav center">
        <ul class="nav__list center">
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/blog/" data-shortcut="b"><strong>b</strong>log</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/cheatsheets/" data-shortcut="c"><strong>c</strong>heatsheets</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/elasticsearch/" data-shortcut="e"><strong>e</strong>lasticsearch</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/js/" data-shortcut="j"><strong>j</strong>s</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/linuxbash/" data-shortcut="l"><strong>l</strong>inuxbash</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/misc/" data-shortcut="m"><strong>m</strong>isc</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/notes/" data-shortcut="n"><strong>n</strong>otes</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/other/" data-shortcut="o"><strong>o</strong>ther</a>
          </li>
          
          <li class="nav__list-item">
            <a class="link link--nav" href="/python/" data-shortcut="p"><strong>p</strong>ython</a>
          </li>
          
        </ul>

        <button type="button" aria-label="search" id="searchBtn" class="btn btn--icon">
          <i aria-hidden="true" class="fas fa-search"></i>
        </button>

        <button type="button" aria-label="toggle theme" class="btn btn--icon">
          <i aria-hidden="true" id="btn-theme" class="fas fa-moon"></i>
        </button>

        <button
          type="button"
          aria-label="toggle navigation"
          class="btn btn--icon nav__hamburger"
        >
          <i aria-hidden="true" class="fas fa-bars"></i>
        </button>
      </nav>
    </header>

    <main>
      <article class="article">
        <div class="article-body">
          <h1><a href="#" data-clipboard="code ~/mjnurse/mjnurse-website/cheatsheets/DOS_CMD.md">DOS - Cmd Cheat Sheet</a></h1>
<div class="table-of-contents">
<h2>Contents</h2>
<ul>
<li><a href="#variables">Variables</a></li>
<li class="toc-h2"><a href="#variable-substitution">Variable Substitution</a></li>
<li class="toc-h2"><a href="#environment-variables">Environment Variables</a></li>
<li><a href="#read-user-input">Read user Input</a></li>
<li><a href="#if-condition">IF Condition</a></li>
<li class="toc-h2"><a href="#file-syntax">File syntax</a></li>
<li class="toc-h2"><a href="#string-syntax">String syntax</a></li>
<li class="toc-h2"><a href="#error-check-syntax">Error Check Syntax</a></li>
<li class="toc-h2"><a href="#parenthesis">Parenthesis</a></li>
<li class="toc-h2"><a href="#an-and-test">An AND test:</a></li>
<li class="toc-h2"><a href="#an-or-test">An OR test:</a></li>
<li><a href="#loops">Loops</a></li>
<li><a href="#other">Other</a></li>
<li class="toc-h2"><a href="#setting-file-attributes">Setting File Attributes</a></li>
<li><a href="#working-with-tasks-processes">Working with tasks (processes):</a></li>
<li><a href="#an-example-script-to-process-command-line-parameters">An example script to process command line parameters</a></li>
<li><a href="#a-script-to-emulate-the-linux-sudo-command">A script to emulate the linux sudo command:</a></li>
<li><a href="#other">Other</a></li>
</ul>
</div>
<h1 id="variables">Variables</h1>
<div class="codehilite"><pre><span></span><code><span class="k">SET</span> <span class="nv">b</span><span class="p">=</span><span class="nv">%a:x=y%</span>   # Replace &#39;x&#39; with &#39;y&#39;.
<span class="k">SET</span> <span class="nv">b</span><span class="p">=</span><span class="nv">%a:xy=%</span>   # Delete the string &#39;xy&#39;.
<span class="k">SET</span> <span class="nv">b</span><span class="p">=</span><span class="nv">%a:*xy=%</span>  # Delete the string &#39;xy&#39; and everything before it.
<span class="k">SET</span> <span class="nv">b</span><span class="p">=</span><span class="nv">%a: =%</span>    # Remove spaces from a string.

<span class="k">SET</span> <span class="nv">s</span><span class="p">=</span>martin
<span class="k">ECHO</span> <span class="nv">%s:~1%</span>     # Yeilds: artin
<span class="k">ECHO</span> <span class="nv">%s:~,-2%</span>   # Yields: mart
<span class="k">ECHO</span> <span class="nv">%s:~1,-1%</span>  # Yields: arti
<span class="k">ECHO</span> <span class="nv">%s:~1,2%</span>   # Yields: ar
</code></pre></div>

<p>To remove characters from the right hand side of a string is a two step process - To delete everything after the string 't':</p>
<div class="codehilite"><pre><span></span><code><span class="k">SET</span> <span class="nv">a</span><span class="p">=</span>Martin
<span class="k">SET</span> <span class="nv">tmp</span><span class="p">=</span><span class="nv">%a:*t=%</span>          # Create tmp string removing &#39;t&#39; and everything before it.
<span class="k">CALL</span> <span class="k">SET</span> <span class="nv">b</span><span class="p">=</span><span class="se">%%</span>a:<span class="nv">%tmp%</span>=<span class="se">%%</span>  # Remove tmp from original string.  Use CALL to expand tmp before replace.
</code></pre></div>

<p>Boolean Test "does string exist ?" - To test for string 'Three':</p>
<div class="codehilite"><pre><span></span><code><span class="k">SET</span> <span class="nv">a</span><span class="p">=</span><span class="s2">&quot;One, Two, Three&quot;</span>
<span class="k">SET</span> <span class="nv">tmp</span><span class="p">=</span><span class="nv">%a:Three=%</span>      # Create tmp string removing &#39;Three&#39; if it exists, then compare or original.
<span class="k">IF</span> <span class="k">NOT</span> <span class="nv">%tmp%</span> <span class="o">==</span> <span class="nv">%a%</span> <span class="p">(</span><span class="k">ECHO</span> found.<span class="p">)</span> <span class="k">ELSE</span> <span class="p">(</span><span class="k">ECHO</span> Not found.<span class="p">)</span>
</code></pre></div>

<h2 id="variable-substitution">Variable Substitution</h2>
<p>| <code>%~V</code> | expands %V removing any surrounding quotes (") |
| <code>%~fV</code> | expands %V to a fully qualified path name |
| <code>%~dV</code> | expands %V to a drive letter only |
| <code>%~pV</code> | expands %V to a path only (directory with ) |
| <code>%~nV</code> | expands %V to a file name only |
| <code>%~xV</code> | expands %V to a file extension only |
| <code>%~sV</code> | expanded path contains short names only |
| <code>%~aV</code> | expands %V to file attributes of file |
| <code>%~tV</code> | expands %V to date/time of file |
| <code>%~zV</code> | expands %V to size of file |</p>
<h2 id="environment-variables">Environment Variables</h2>
<div class="codehilite"><pre><span></span><code>setx <span class="p">&lt;</span>var_name<span class="p">&gt;</span> &lt;var_value<span class="p">&gt;</span> [/M]
</code></pre></div>

<p><code>/M</code> makes this a System variable rather than User variable.  <code>/M</code> requires administrator privileges.</p>
<h1 id="read-user-input">Read user Input</h1>
<div class="codehilite"><pre><span></span><code>set /p &quot;value=Enter value: &quot;
echo %value%
</code></pre></div>

<h1 id="if-condition">IF Condition</h1>
<h2 id="file-syntax">File syntax</h2>
<div class="codehilite"><pre><span></span><code><span class="k">IF</span> [NOT]<span class="err"> EXIST filename command </span>
<span class="k">IF</span> [NOT]<span class="err"> EXIST filename (command) ELSE (command)</span>
</code></pre></div>

<h2 id="string-syntax">String syntax</h2>
<div class="codehilite"><pre><span></span><code><span class="k">IF</span> [/I]<span class="err"> [NOT] item1</span><span class="o">==</span>item2 command   # /I - case insensitive.
<span class="k">IF</span> [/I]<span class="err"> item1 compare-op item2 command</span>
<span class="k">IF</span> [/I]<span class="err"> item1 compare-op item2 (command) ELSE (command)</span>

<span class="k">IF</span> [<span class="nv">%1</span>]<span class="o">==</span>[] <span class="k">ECHO</span> Value Missing  # Check for missing command line parameter.  (can use EQU in place of ==)

# Compare-op can be: EQU (==), NEQ (!=), LSS (<span class="p">&lt;</span>), LEQ (<span class="p">&lt;</span>=), GTR (?), GEQ (<span class="p">&gt;</span>=).
# (This syntax is necessary because the <span class="p">&gt;</span> and <span class="p">&lt;</span> symbols are redirection operators)

# The == comparison operator always results in a string comparison.  EQU will compare numbers.

# Filenames/Paths - Always surround them with quotes: if <span class="nv">%_myvar%</span> contains <span class="s2">&quot;C:\Some Path&quot;</span> then 
# comparison becomes IF [<span class="s2">&quot;C:\Some Path&quot;</span>] EQU []
</code></pre></div>

<h2 id="error-check-syntax">Error Check Syntax</h2>
<div class="codehilite"><pre><span></span><code><span class="k">IF</span> [NOT]<span class="err"> DEFINED variable command  # Note: DEFINED will return true for a space character.</span>
<span class="k">IF</span> [NOT]<span class="err"> ERRORLEVEL number command </span>
<span class="k">IF</span> CMDEXTVERSION<span class="err"> number command</span>
</code></pre></div>

<h2 id="parenthesis">Parenthesis</h2>
<p>Parenthesis can be used to split commands across multiple lines.</p>
<div class="codehilite"><pre><span></span><code><span class="k">IF</span> <span class="k">EXIST</span> filename.txt <span class="p">(</span>
    <span class="k">ECHO</span> Deleting filename.txt
    <span class="k">DEL</span> filename.txt
 <span class="p">)</span> <span class="k">ELSE</span> <span class="p">(</span>             # Note: Always put the parenthesis on the same line as ELSE.
    <span class="k">ECHO</span> The file was not found.
 <span class="p">)</span>
</code></pre></div>

<h2 id="an-and-test">An AND test:</h2>
<div class="codehilite"><pre><span></span><code><span class="k">IF</span> SomeCondition<span class="err"> (</span>
   <span class="k">IF</span> SomeOtherCondition<span class="err"> (</span>
     Command_if_both_are_true
   <span class="c1">)</span>
<span class="c1">)</span>
</code></pre></div>

<h2 id="an-or-test">An OR test:</h2>
<div class="codehilite"><pre><span></span><code><span class="k">SET</span> <span class="s2">&quot;tmp=&quot;</span>
<span class="k">IF</span> SomeCondition<span class="err"> SET tmp=1</span>
<span class="k">IF</span> SomeOtherCondition<span class="err"> SET tmp=1</span>
<span class="k">IF</span> <span class="nv">%tmp%</span> <span class="ow">EQU</span> 1 Command_to_run_if_either_is_true
</code></pre></div>

<h3 id="notes">Notes:</h3>
<ul>
<li>Delimiters - If the string being compared includes delimiters such as [Space] or [Comma], then the delimiters must be escaped with a caret ^ or the whole string must be "quoted".</li>
<li>Wildcards - Wildcards are not supported by IF.  Use variable string transforms instead.</li>
</ul>
<h1 id="loops">Loops</h1>
<div class="codehilite"><pre><span></span><code><span class="k">FOR</span> <span class="se">%%</span>f <span class="k">IN</span> <span class="p">(</span>file1.txt file2.txt<span class="p">)</span> <span class="k">DO</span> <span class="k">ECHO</span> <span class="se">%%</span>f
<span class="k">FOR</span> <span class="k">/L</span> <span class="se">%%</span>i <span class="k">IN</span> <span class="p">(</span><span class="mi">0</span>,<span class="mi">2</span>,<span class="mi">10</span><span class="p">)</span> <span class="k">DO</span> <span class="k">ECHO</span> <span class="se">%%</span>i # Yields 0 2 4 6 8 10
<span class="k">FOR</span> <span class="k">/F</span> <span class="se">%%</span>l <span class="k">IN</span> <span class="p">(</span>file.txt<span class="p">)</span> <span class="k">DO</span> <span class="k">ECHO</span> <span class="se">%%</span>l

# delims= overrides default space delimiter so whole line is a single token
<span class="k">FOR</span> <span class="k">/F</span> <span class="s2">&quot;delims=&quot;</span> <span class="se">%%</span>line <span class="k">IN</span> <span class="p">(</span>file.txt<span class="p">)</span> <span class="k">DO</span> <span class="k">ECHO</span> <span class="se">%%</span>line
# tokens=* overrides default token=1 to return all tokens using the default space delimiter
<span class="k">FOR</span> <span class="k">/F</span> <span class="s2">&quot;tokens=*&quot;</span> <span class="se">%%</span>line <span class="k">IN</span> <span class="p">(</span>file.txt<span class="p">)</span> <span class="k">DO</span> <span class="k">ECHO</span> <span class="se">%%</span>line
<span class="k">FOR</span> <span class="k">/F</span> <span class="s2">&quot;tokens=*&quot;</span> <span class="se">%%</span>character <span class="k">IN</span> <span class="p">(</span><span class="s2">&quot;I am cool&quot;</span><span class="p">)</span> <span class="k">DO</span> <span class="k">ECHO</span> <span class="se">%%</span>character
<span class="k">FOR</span> <span class="k">/F</span> <span class="s2">&quot;tokens=*&quot;</span> <span class="se">%%</span>l <span class="k">IN</span> <span class="p">(</span><span class="s1">&#39;DIR /B&#39;</span><span class="p">)</span> <span class="k">DO</span> <span class="k">ECHO</span> <span class="se">%%</span>l
</code></pre></div>

<h1 id="other">Other</h1>
<ul>
<li>To echo the &gt; symbol use: ^&gt;</li>
<li>To echo the % symbol use: %%</li>
<li>To exit script but not the cmd.exe: <code>exit /B</code></li>
</ul>
<h2 id="setting-file-attributes">Setting File Attributes</h2>
<ul>
<li><code>attrib -r &lt;filename&gt;</code> - removes readonly</li>
</ul>
<h1 id="working-with-tasks-processes">Working with tasks (processes):</h1>
<div class="codehilite"><pre><span></span><code><span class="p">:</span><span class="c1">: List tasks</span>
<span class="p">&gt;</span> tasklist

<span class="p">:</span><span class="c1">: Kill task</span>
taskkill /F /PID <span class="p">&lt;</span>pid_number&gt;
taskkill /IM <span class="p">&lt;</span><span class="s2">&quot;process name&quot;</span><span class="p">&gt;</span> /F
</code></pre></div>

<h1 id="an-example-script-to-process-command-line-parameters">An example script to process command line parameters</h1>
<div class="codehilite"><pre><span></span><code><span class="p">@</span><span class="k">ECHO</span> OFF
<span class="k">SETLOCAL</span> EnableDelayedExpansion
<span class="p">(</span><span class="k">SET</span> <span class="nv">n</span><span class="p">=</span><span class="se">^</span>
<span class="se">%</span>doNotDeleteThisLine%
<span class="p">)</span>
<span class="k">GOTO</span> <span class="p">:</span><span class="nl">START</span>

<span class="p">:</span><span class="nl">HELP</span>
<span class="k">ECHO</span> <span class="nv">!n!</span><span class="se">^</span>
<span class="se">A</span> sample script to parse command line parameters. <span class="nv">!n!</span><span class="se">^</span>
<span class="se"> </span>                                                 <span class="nv">!n!</span><span class="se">^</span>
<span class="se">p</span>rocess-params [/D] [/H] [/V value]               <span class="nv">!n!</span><span class="se">^</span>
<span class="se"> </span>                                                 <span class="nv">!n!</span><span class="se">^</span>
<span class="se"> </span> /D   Enable Debug.                              <span class="nv">!n!</span><span class="se">^</span>
<span class="se"> </span> /H   Displays this help.                        <span class="nv">!n!</span><span class="se">^</span>
<span class="se"> </span> /V   Sets variable value.                       <span class="nv">!n!</span>

<span class="k">EXIT</span> /B
<span class="p">:</span><span class="nl">START</span>

<span class="k">SET</span> <span class="nv">debugYN</span><span class="p">=</span>N
<span class="k">SET</span> <span class="nv">val</span><span class="p">=</span>

<span class="p">:</span><span class="nl">LOOP</span>
  <span class="k">IF</span> [<span class="nv">%1</span>]<span class="o">==</span>[] <span class="k">GOTO</span> <span class="p">:</span><span class="nl">END_LOOP</span>
  <span class="k">SET</span> <span class="nv">par</span><span class="p">=</span><span class="nv">%1</span>
  <span class="k">SHIFT</span>

  <span class="k">IF</span> [<span class="nv">%par%</span>]<span class="o">==</span>[/H] <span class="p">(</span>
    <span class="k">GOTO</span> <span class="p">:</span><span class="nl">HELP</span>
  <span class="p">)</span>

  <span class="k">IF</span> [<span class="nv">%par%</span>]<span class="o">==</span>[-d] <span class="p">(</span>
    <span class="k">SET</span> <span class="nv">debugYN</span><span class="p">=</span>Y
    <span class="k">GOTO</span> <span class="p">:</span><span class="nl">LOOP</span>
  <span class="p">)</span>

  <span class="k">IF</span> [<span class="nv">%par%</span>]<span class="o">==</span>[-v] <span class="p">(</span>
    <span class="k">SET</span> <span class="nv">val</span><span class="p">=</span><span class="nv">%1</span>
    <span class="k">SHIFT</span>
    <span class="k">GOTO</span> <span class="p">:</span><span class="nl">LOOP</span>
  <span class="p">)</span>

  <span class="k">ECHO</span> NOT PROCESSED <span class="nv">%par%</span>
  <span class="k">GOTO</span> <span class="p">:</span><span class="nl">LOOP</span>
<span class="p">:</span><span class="nl">END_LOOP</span>

<span class="k">ECHO</span> debugYN: <span class="nv">%debugYN%</span>
<span class="k">ECHO</span> value:   <span class="nv">%val%</span>
</code></pre></div>

<h1 id="a-script-to-emulate-the-linux-sudo-command">A script to emulate the linux sudo command:</h1>
<p>Create a script <code>sudo.bat</code>:</p>
<div class="codehilite"><pre><span></span><code><span class="p">@</span><span class="k">echo</span> Set objShell = CreateObject(<span class="s2">&quot;Shell.Application&quot;</span>) <span class="p">&gt;</span> <span class="nv">%temp%</span>\sudo.tmp.vbs
<span class="p">@</span><span class="k">echo</span> args = Right(<span class="s2">&quot;</span><span class="nv">%*</span><span class="s2">&quot;</span>, (Len(<span class="s2">&quot;</span><span class="nv">%*</span><span class="s2">&quot;</span>) - Len(<span class="s2">&quot;</span><span class="nv">%1</span><span class="s2">&quot;</span>))) <span class="p">&gt;&gt;</span> <span class="nv">%temp%</span>\sudo.tmp.vbs
<span class="p">@</span><span class="k">echo</span> objShell.ShellExecute <span class="s2">&quot;</span><span class="nv">%1</span><span class="s2">&quot;</span>, args, <span class="s2">&quot;&quot;</span>, <span class="s2">&quot;runas&quot;</span> <span class="p">&gt;&gt;</span> <span class="nv">%temp%</span>\sudo.tmp.vbs
<span class="p">@</span>cscript <span class="nv">%temp%</span>\sudo.tmp.vbs
</code></pre></div>

<p>To open a new cmd window running as administrator:</p>
<div class="codehilite"><pre><span></span><code><span class="p">&gt;</span> sudo cmd
</code></pre></div>

<p>I did have some issues if I pass in multiple parameters to sudo, but I'll leave that for another day.</p>
<h1 id="other_1">Other</h1>
<div class="codehilite"><pre><span></span><code><span class="p">:</span><span class="c1">: Get current directory</span>
<span class="k">SET</span> <span class="nv">curr_dir</span><span class="p">=</span><span class="nv">%cd%</span>
</code></pre></div>

<hr>
        </div>
      </article>
    </main>

    <footer class="footer">
      <p>
        <a href="/about_me.html" class="link">About Me</a> | 
        <a href="/help.html" class="link">Help</a>
      </p>
      <p>
        <a href="https://github.com/mjnurse" target="_blank" rel="noopener noreferrer" aria-label="GitHub" class="link footer__link">
          <i aria-hidden="true" class="fab fa-github"></i>
        </a>
        <a href="https://www.linkedin.com/in/martin-nurse" target="_blank" rel="noopener noreferrer" aria-label="LinkedIn" class="link footer__link">
          <i aria-hidden="true" class="fab fa-linkedin"></i>
        </a>
      </p>
      <p>Last updated: December 11, 2025</p>
    </footer>

    <div class="scroll-container">
      <div class="scroll-top">
        <a aria-label="Scroll up" href="#top">
          <i aria-hidden="true" class="fas fa-arrow-up"></i>
        </a>
      </div>
    </div>

    <script src="/static/page-nav.js"></script>
    <script src="/static/script.js"></script>
    <script src="/static/search.js"></script>
  </body>
</html>